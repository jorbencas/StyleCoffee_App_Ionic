<ion-header>
  <ion-toolbar [hidden]="search" [color]="authenticated == true ? 'dark' : 'default'">
    <ion-buttons slot="start">
      <ion-menu-button></ion-menu-button>
    </ion-buttons>
    <ion-title>Stylecoffee</ion-title>
    <ion-segment [color]="authenticated == true ? 'light' : 'primary'" value='book'>
      <ion-segment-button value="book" (ionSelect)="setab($event.target.value)">
        <ion-icon name="bookmarks">Libros</ion-icon>
      </ion-segment-button>
      <ion-segment-button value="coffee" (ionSelect)="setab($event.target.value)">
        <ion-icon name="cafe">Cafés</ion-icon>
      </ion-segment-button>
    </ion-segment>
    <ion-buttons slot="end">
      <ion-button (click)="cansearch()">
        <ion-icon slot="icon-only" name="search"></ion-icon>
      </ion-button>
    </ion-buttons>
    <ion-avatar slot="end">
      <img *ngIf="!authenticated" [routerLink]="['/login']"
        src="https://gravatar.com/avatar/dba6bae8c566f9d4041fb9cd9ada7741?d=identicon&f=y"
        alt="https://cdn2.iconfinder.com/data/icons/scenarium-vol-4/128/002_avatar_man_profile_account_user_male-128.png">

      <img *ngIf="authenticated" [routerLink]="['/profile', currentUser.usuario]" [src]="currentUser.avatar"
        alt="https://cdn2.iconfinder.com/data/icons/scenarium-vol-4/128/002_avatar_man_profile_account_user_male-128.png">
    </ion-avatar>
  </ion-toolbar>

  <ion-toolbar [hidden]="!search" [color]="authenticated == true ? 'dark' : 'default'">
    <ion-buttons slot="start">
      <ion-button (click)="cansearch()">
        <ion-icon name='arrow-back'></ion-icon>
      </ion-button>
    </ion-buttons>
    <ion-searchbar [(ngModel)]="queryText" [color]="authenticated == true ? 'dark' : 'default'"
      (ionChange)="updateSchedule()" placeholder="Search" animated autocorrect='on'></ion-searchbar>
  </ion-toolbar>
</ion-header>

<ion-content>
  <div [hidden]='infos.length > 0 || coffees.length > 0'>
    <ion-grid>
      <ion-row>
        <ion-col>
          <ion-item>
            <ion-icon [hidden]="tab_active !== 'book'" name="bookmarks" text-center></ion-icon>
            <ion-icon [hidden]="tab_active !== 'coffee'" name="cafe" text-center></ion-icon>
            <ion-text text-center> No hay {{tab_active}} disponibles!!!</ion-text>
          </ion-item>
        </ion-col>
      </ion-row>
      <!--<ion-row [ngStyle]="{'width': 320, 'height': 510}">
        <ion-col>
          <ion-list class="ion-padding custom-skeleton">
            <ion-item animated style="width: 100%">
              <ion-avatar slot="start">
                <ion-skeleton-text animated></ion-skeleton-text>
              </ion-avatar>
              <p animated style="width: 20%">
                <ion-skeleton-text animated style="width: 30%"></ion-skeleton-text>
              </p>
            </ion-item>
            <ion-item animated style="width: 20%">
              <ion-buttons slot="start">
                <ion-skeleton-text animated style="width: 20%"></ion-skeleton-text>
              </ion-buttons>
              <ion-buttons slot="end">
                <ion-skeleton-text animated style="width: 20%"></ion-skeleton-text>
              </ion-buttons>
            </ion-item>
          </ion-list>
        </ion-col>
      </ion-row> -->
    </ion-grid>
  </div>

  <!--   <ion-button *ngIf="tab_active == 'book'" (click)="toggleInfiniteScroll()" expand="block">
    Toggle Infinite Scroll
  </ion-button> -->


  <app-filter *ngIf="infos.length > 0" [hidden]="tab_active !== 'book'"></app-filter>
  <ion-refresher slot="fixed" (ionRefresh)="doRefresh($event)">
    <ion-refresher-content></ion-refresher-content>
  </ion-refresher>

  <ion-grid *ngIf="infos.length > 0" [hidden]="tab_active !== 'book'" >
      <ion-col *ngFor="let info of infos; let i of index" size='12'>
        <ion-row routerLink="/details/{{info.isbn}}">
          <ion-col size='4'>
            <ion-img class="item-img" src="{{info.image}}" alt="{{info.titulo}}"></ion-img>
          </ion-col>
          <ion-col size='8'>
              <p id="{{info.isbn}}" >{{info.titulo}}</p>
              <p>{{info.name}}</p>
              <p> {{info.price}} €</p>
          </ion-col>
        </ion-row>
      <ion-row *ngIf="authenticated">
          <ion-col size="1">
            <ion-buttons>
              <ion-icon name="heart" id="{{info.isbn}}" [color]="info.favorite == 1 ? 'danger':'default'"
                (click)="clickEventHandler($event.target)"></ion-icon>
            </ion-buttons>
          </ion-col>
          <ion-col size="1">
            <ion-buttons>
              <ion-icon name="archive" id="{{info.isbn}}" [color]="colorSecundary"
                (click)="clickEventHandlerSave($event.target)"></ion-icon>
            </ion-buttons>
          </ion-col>
        </ion-row>
      </ion-col>
  </ion-grid>

  <!--  <ion-button *ngIf="tab_active == 'coffee'" (click)="toggleInfiniteScroll()" expand="block">
    Toggle Infinite Scroll
  </ion-button>  -->

  <app-filter *ngIf="coffees.length > 0"   [hidden]="tab_active !== 'coffee'"></app-filter>
  <ion-refresher slot="fixed" (ionRefresh)="doRefresh($event)">
    <ion-refresher-content></ion-refresher-content>
  </ion-refresher>

  <ion-list  *ngIf="coffees.length > 0"  [hidden]="tab_active !== 'coffee'">
    <ion-item *ngFor="let info of coffees" [ngStyle]="{'width': 320, 'height': 510}" routerLinkActive="active"
      [routerLinkActiveOptions]="{ exact: true }" routerLink="/coffeedetails/{{info.id}}">
      <ion-img width="auto" height="350px" src="{{info.image}}" alt="{{info.displayName}}"></ion-img>
    </ion-item>
    <ion-item *ngIf="authenticated">
      <ion-buttons slot="start">
        <ion-icon name="archive" (click)="clickEventHandlerSave($event.target)"></ion-icon>
      </ion-buttons>
      <ion-title *ngFor="let info of coffees" routerLinkActive="active" [routerLinkActiveOptions]="{ exact: true }"
        routerLink="/coffeedetails/{{info.id}}">{{info.name}}</ion-title>
    </ion-item>
  </ion-list>

  <!--   <ion-infinite-scroll threshold="100px" (ionInfinite)="loadData($event)">
    <ion-infinite-scroll-content
      loadingSpinner="bubbles"
      loadingText="Loading more data...">
    </ion-infinite-scroll-content>
  </ion-infinite-scroll> -->

</ion-content>